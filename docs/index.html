<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <style>
    html, body, .app-wrapper {
      display: flex;
      height: 100%;
      width: 100%;
      overflow: hidden;
      margin: 0;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    body {
      flex-direction: column;
      position: relative;
    }
    .app-wrapper {
      position: relative;
    }

    section {
      /* background: #eee; */
      padding: 6px 12px;
      box-sizing: border-box;
      
      margin-bottom: 24px;
      width: 100%;
    }

    main {
      position: relative;
      height: 100%;
    width: 100%;
    align-items: center;
    display: flex;
    flex-direction: column;
    }

    .viewer, .marked {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: 0;
      pointer-events: none;
      transform: translateY(-110%);
    }

    main [selected] {
      pointer-events: auto;
      opacity: 1;
      transform: translateY(0);
    }

    aside [selected] {
      background: #555;
      color: #f7f7f7;
    }

    code {
      display: block;
      padding: 6px 12px;
      box-sizing: border-box;
      margin-top: 0;
      margin-bottom: 24px;
      padding: 12px;
      font-size: 1em;
      background: #f7f7f7;
      border-radius: 2px;
      overflow-x: auto;
    }

    .wrapper {
      max-width: 960px;
      width: 100%;
      position: relative;
      overflow-y: auto;
      height: 100%;
    }

    aside {
      display: flex;
      flex-direction: column;
      height: 100%;
      width: 256px;
      box-shadow: 1px 1px 8px 0px #5555557a;
    }

    a {
      text-decoration: none;
      display: flex;
      padding: 12px 24px;
      box-sizing: border-box;
      height: 48px;
      width: 100%;
      align-items: center;
    }

    .toolbar {
      display: flex;
      height: 54px;
      width: 100%;
      box-shadow: 1px 1px 8px 0px #5555557a;
    }
  </style>
  <span class="toolbar">

    <a class="branding">DocIt</a>
  </span>
  <span class="app-wrapper">
    <aside>
      <a href="#!/home">home</a>
    </aside>
    
    <main>
      <div class="wrapper">
        <div class="viewer">
          <h2 class="title"></h2>
          <span class="classes">
            <h2>class</h2>
          </span>
          <span class="properties">
            <h2>properties</h2>
          </span>
      
          <span class="methods">
            <h2>methods</h2>
          </span>
        </div>
        <div class="marked"></div>
      </div>
    </main>
    
  </span>
  
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script type="module">

    const pages = [
	"addresses.js",
	"chain.js",
	"machine.js",
	"node.js",
	"state.js",
	"typer.js",
	"lib.js",
	"node-config.js",
	"messages.js",
	"miniframe.js",
	"mnemonic.js",
	"wordlist.js",
	"networks.js",
	"index.js",
	"utils.js",
	"wallet.js",
	"block-worker.js",
	"machine-worker.js",
	"pool-worker.js",
	"transaction-worker.js",
	"workers.js",
	"config.js",
	"main.js",
	"protocol.js",
	"factory.js",
	"name-service.js",
	"native-token.js",
	"power-token.js",
	"validators.js",
	"config.js",
	"initializer.js",
	"roles.js",
	"token.js",
	"voting.js",
	"transaction.js",
	"validator.js",
	"block.js",
	"bw-request.js",
	"bw.js",
	"contract.js",
	"last-block-request.js",
	"last-block.js",
	"transaction.js",
	"block.proto.js",
	"bw-request.proto.js",
	"bw.proto.js",
	"contract.proto.js",
	"last-block-request.proto.js",
	"last-block.proto.js",
	"transaction.proto.js",
	"base-class.js",
	"helpers.js",
	"load.js",
	"script.js",
	"elevation.js",
	"styles.js",
	"html.js",
	"utils.js",
	"client.js",
	"peer.js",
	"api.js",
	"server.js",
	"utils.js"
]
    const readme ="# monorepo\r\n"
    const aside = document.querySelector('aside')
    for (const page of pages) {
      const a = document.createElement('a')
      a.href = `#!/${page}`
      a.innerHTML = page.replace('.js', '')
      aside.appendChild(a)
    }

    const onhashchange = () => {
      let selected = location.hash
      selected = selected.split('#!/')[1]

      console.log(selected);
      aside.querySelector('[selected]')?.removeAttribute('selected')
      
      aside.querySelector(`a[href="#!/${selected}"]`).setAttribute('selected', '')
      marked.setOptions({
        highlight: function(code, lang) {
          return hljs.highlight(code, {language: lang}).value;
        }
      });
      if (selected === 'home') {
        document.querySelector('.viewer')?.removeAttribute('selected')
        document.querySelector('.marked').setAttribute('selected', '')
        document.querySelector('.marked').innerHTML = marked.parse(readme);
      } else {
        document.querySelector('main').querySelector('.marked')?.removeAttribute('selected')
        document.querySelector('main').querySelector('.viewer').setAttribute('selected', '')
      }
    }

    globalThis.onhashchange = onhashchange

    const properties = document.querySelector('.properties')
    const methods = document.querySelector('.methods')
    const classes = document.querySelector('.classes')
    const title = document.querySelector('.title')

    if (!location.hash) location.hash = '#!/home'
    onhashchange()
    for (const page of pages) {
      const importee = await import(`./${page}`)
      const data = importee.default
console.log(data);
      title.innerHTML = page
      for (const token of data) {
        if (token.type === 'property') {
          const property = document.createElement('section')
          property.innerHTML = `
          <h3>${token.name}</h3>
          <code>
          <p><strong>type</strong> ${token.params[0].type}</p>
          ${token.description === token.value ? '' : `${token.description}`}
          <p><strong>defaultValue</strong> ${token.value}</p>
          </code>
          `
          properties.appendChild(property)
        }
        if (token.type === 'method') {
          const property = document.createElement('section')
          property.innerHTML = `          
          <h3>${token.name}</h3>
          <code>
          ${token.params ? token.params.map(param => `
            <p><strong>type</strong> ${param.type}</p>
            <p><strong>param</strong> ${param.name}</p>
            <p><strong>description</strong> ${param.description}</p>
            `).join('') : []}
          
          ${token.description === token.value ? '' : token.description.startsWith('/**') ? '' : token.description}  
          ${token.return ? `<p><strong>returns</strong> ${token.return.type ? `${token.return.name}: ${token.return.type}` : token.return.name} ${token.return.value ? `&lt;${token.return.description}&gt;` : ''}</p>` : ''}
          </code>
          `
          
          methods.appendChild(property)
        }

        if (token.type === 'class') {
          const property = document.createElement('section')
          property.innerHTML = `<h3>${token.name}</h3>
          <code>
          
          ${token.description === token.value ? '' : token.description.startsWith('/**') ? '' : token.description}  
          </code>
          `
          classes.appendChild(property)
        }
      }
    }
    // document.querySelector('.viewer').innerHTML = marked.parse(readme);
  </script>
</body>
</html>