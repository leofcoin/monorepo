import BlockMessage from "./exports/messages/block.js";
import BWRequestMessage from "./exports/messages/bw-request.js";
import { ContractMessage } from "./exports/index.js";

console.log(globalThis.peernet);
// globalThis.peernet.codecs
const validators = [{
  address: 'address',
  reward: 0
}]

const transactions = []
for (let i = 0; i <= 1_235; i++) {
  transactions.push(
    {
      timestamp: new Date().getTime(),
      from: 'fromAddress',
      to: 'toAddress',
      nonce: 0,
      method: 'getAddress',
      params: [],
      signature: new Uint8Array(32)
    }
  )
}

const block = {
  index: 0,
  previousHash: 'hash',
  timestamp: new Date().getTime(),
  reward: 0,
  fees: 0,
  transactions,
  validators
}
const contractMessage = new ContractMessage({
  creator: '',
  contract: new Uint8Array(),
  constructorParameters: []
})
console.log({contractMessage});
const bw = new BWRequestMessage()

const message = new BlockMessage(block)
console.time('message encoded')
await message.encode()
console.timeEnd('message encoded')
console.time('normal encoded')
const normalEncoded = new TextEncoder().encode(JSON.stringify(block))
console.timeEnd('normal encoded')

console.log('# is smaller then normal encoded');
console.info(`normal: ${normalEncoded.length}\nmessage: ${message.encoded.length}`);
console.log(normalEncoded.length > message.encoded.length);

const contract = new ContractMessage('237,198,141,3,53,89,84,113,120,75,115,104,87,72,52,81,111,55,75,112,114,71,89,120,81,86,67,78,89,117,116,101,100,97,69,54,89,71,111,85,100,85,80,110,85,100,70,85,86,66,80,114,84,122,103,115,114,80,238,4,99,108,97,115,115,32,70,97,99,116,111,114,121,123,35,110,97,109,101,61,34,65,114,116,79,110,108,105,110,101,67,111,110,116,114,97,99,116,70,97,99,116,111,114,121,34,59,35,116,111,116,97,108,67,111,110,116,114,97,99,116,115,61,48,59,35,99,111,110,116,114,97,99,116,115,61,91,93,59,99,111,110,115,116,114,117,99,116,111,114,40,115,116,97,116,101,41,123,115,116,97,116,101,38,38,40,116,104,105,115,46,35,99,111,110,116,114,97,99,116,115,61,115,116,97,116,101,46,99,111,110,116,114,97,99,116,115,44,116,104,105,115,46,35,116,111,116,97,108,67,111,110,116,114,97,99,116,115,61,115,116,97,116,101,46,116,111,116,97,108,67,111,110,116,114,97,99,116,115,41,125,103,101,116,32,115,116,97,116,101,40,41,123,114,101,116,117,114,110,123,116,111,116,97,108,67,111,110,116,114,97,99,116,115,58,116,104,105,115,46,35,116,111,116,97,108,67,111,110,116,114,97,99,116,115,44,99,111,110,116,114,97,99,116,115,58,116,104,105,115,46,35,99,111,110,116,114,97,99,116,115,125,125,103,101,116,32,110,97,109,101,40,41,123,114,101,116,117,114,110,32,116,104,105,115,46,35,110,97,109,101,125,103,101,116,32,99,111,110,116,114,97,99,116,115,40,41,123,114,101,116,117,114,110,91,46,46,46,116,104,105,115,46,35,99,111,110,116,114,97,99,116,115,93,125,103,101,116,32,116,111,116,97,108,67,111,110,116,114,97,99,116,115,40,41,123,114,101,116,117,114,110,32,116,104,105,115,46,35,116,111,116,97,108,67,111,110,116,114,97,99,116,115,125,97,115,121,110,99,32,114,101,103,105,115,116,101,114,67,111,110,116,114,97,99,116,40,97,100,100,114,101,115,115,41,123,105,102,40,97,119,97,105,116,32,109,115,103,46,115,116,97,116,105,99,67,97,108,108,40,97,100,100,114,101,115,115,44,34,104,97,115,82,111,108,101,34,44,91,109,115,103,46,115,101,110,100,101,114,44,34,79,87,78,69,82,34,93,41,44,116,104,105,115,46,35,99,111,110,116,114,97,99,116,115,46,105,110,99,108,117,100,101,115,40,97,100,100,114,101,115,115,41,41,116,104,114,111,119,32,110,101,119,32,69,114,114,111,114,40,34,97,108,114,101,97,100,121,32,114,101,103,105,115,116,101,114,101,100,34,41,59,116,104,105,115,46,35,116,111,116,97,108,67,111,110,116,114,97,99,116,115,43,61,49,44,116,104,105,115,46,35,99,111,110,116,114,97,99,116,115,46,112,117,115,104,40,97,100,100,114,101,115,115,41,125,125,114,101,116,117,114,110,32,70,97,99,116,111,114,121,59,2,91,93')
console.log(contract);